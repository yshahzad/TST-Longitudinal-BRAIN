# BRAIN-Lab-TST-Longitudinal
This repository contains the R scripts used to perform the data analysis for the Brain Research and Imaging of Neurorehabilitation (BRAIN) Lab’s “Brain Canada Longitudinal Project”. For anyone who may be concerned with reproducing the analysis, there are three scripts of use.

* ManuscriptPlots_BrainCanadaLongitudinal.rmd 
    * This is an R Markdown file that uses the libraries ggplot2 and tidyr to plot participants' change in outcome measures over time. 
* Demographics_BrainCanadaLongitudinal.R 
    * This is a script used to analyze sociodemographic data and test for between-group differences using Chi-Squared tests for proportions (ex. stroke type) and ANOVA for continuous variables (ex. age). 
    * Importantly, this file is also used to analyze between-group differences in outcome measures at baseline (ex. FMA at T1). This is because the process of testing for between-group differences in continuous demographic characteristics and in outcome measures is very similar. The baseline_values() function is provided to conduct the appropriate ANOVA, conduct the post-hoc Turkey HSD test if necessary, and display the mean and standard deviation of the measures in each group. The function takes arguments response_var, which is the continuous response variable, and explanatory_var, which is the MEP group to which participants were assigned. 
* BrainCanadaFinal.R
    * This file was used to perform analysis on the differences between evaluations, seeing if functional gains were maintained at one-year follow-up. Paired Wilcoxon signed-rank tests were performed, as well as ANCOVAs to test between-group differences in maintenance. Effect sizes are reported as Cohen’s d for the Wilcox test, attesting to the maintenance level over time, and partial eta-squared, attesting to the dependency of maintenance level on stroke severity. The bootstrap_CI() function is provided to return bootstrapped 95% confidence intervals of differences between evaluations (ex. BBT at T3 minus BBT at T1). We opted to bootstrap the confidence intervals because of failure to normalize the differences through standard transformations, likely due to the ceiling effect that some measures created (such as FMA and MAL for participants in, especially, the HI group). The bootstrap_CI() function takes arguments “difference”, which is a vector of differences in some outcome variable between one evaluation and another, and “n” which is simply the sample size of the entire cohort.

For any questions regarding the code or analysis, feel free to [get in touch](yshahzad.github.io).
